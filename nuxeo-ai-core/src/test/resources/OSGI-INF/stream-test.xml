<?xml version="1.0"?>
<component name="org.nuxeo.enrichment.stream.test" version="1.0">

  <extension point="enrichment" target="org.nuxeo.ai.services.AIComponent">
    <enrichment name="simpleTest" kind="/tagging/imageLabels" class="org.nuxeo.ai.enrichment.BasicEnrichmentService">
      <mimeTypes>
        <mimeType name="image/jpeg"/>
      </mimeTypes>
      <encoding>UTF-8</encoding>
      <option name="maxResults">50</option>
      <option name="features">all</option>
      <option name="labels">George,Paul</option>
    </enrichment>
  </extension>

  <extension target="org.nuxeo.runtime.stream.service" point="streamProcessor">
    <streamProcessor name="simpleProcessor" logConfig="test_enrichment" defaultConcurrency="1" defaultPartitions="1"
                     class="org.nuxeo.ai.enrichment.EnrichingStreamProcessor">
      <option name="source">test_images</option>
      <option name="sink">test_images.out</option>
      <option name="enrichmentServiceName">simpleTest</option>
    </streamProcessor>
  </extension>

  <extension target="org.nuxeo.runtime.stream.service" point="streamProcessor">
    <streamProcessor name="tagsProcessor" logConfig="test_enrichment" defaultConcurrency="1" defaultPartitions="1"
                     class="org.nuxeo.ai.functions.StoreLabelsAsTags">
      <option name="source">test_images.out</option>
    </streamProcessor>
  </extension>

  <extension target="org.nuxeo.runtime.stream.service" point="streamProcessor">
    <streamProcessor name="saveMetadataProcessor" defaultConcurrency="1" defaultPartitions="1"
                     logConfig="test_enrichment"
                     class="org.nuxeo.ai.functions.SaveEnrichmentFunction">
      <option name="source">test_images.out</option>
    </streamProcessor>
  </extension>
</component>
